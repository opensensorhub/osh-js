define(["./when-8166c7dd","./Matrix2-92b7fb9d","./GeometryOffsetAttribute-e8e698d7","./Transforms-62a339c3","./ComponentDatatype-9ed50558","./RuntimeError-4fdc4459","./GeometryAttribute-6f4c3b93","./GeometryAttributes-50becc99","./IndexDatatype-797210ca","./PolygonPipeline-7fb6627c","./RectangleGeometryLibrary-fdac9734","./combine-a5c4cc47","./WebGLConstants-0664004c","./EllipsoidRhumbLine-51654311"],(function(e,t,i,r,a,n,o,l,u,s,d,c,p,f){"use strict";var g=new r.BoundingSphere,h=new r.BoundingSphere,y=new t.Cartesian3,m=new t.Rectangle;function b(e,t){var i=e._ellipsoid,r=t.height,n=t.width,s=t.northCap,c=t.southCap,p=r,f=2,g=0,h=4;s&&(f-=1,p-=1,g+=1,h-=2),c&&(f-=1,p-=1,g+=1,h-=2),g+=f*n+2*p-h;var m,b=new Float64Array(3*g),v=0,_=0,E=y;if(s)d.RectangleGeometryLibrary.computePosition(t,i,!1,_,0,E),b[v++]=E.x,b[v++]=E.y,b[v++]=E.z;else for(m=0;m<n;m++)d.RectangleGeometryLibrary.computePosition(t,i,!1,_,m,E),b[v++]=E.x,b[v++]=E.y,b[v++]=E.z;for(m=n-1,_=1;_<r;_++)d.RectangleGeometryLibrary.computePosition(t,i,!1,_,m,E),b[v++]=E.x,b[v++]=E.y,b[v++]=E.z;if(_=r-1,!c)for(m=n-2;m>=0;m--)d.RectangleGeometryLibrary.computePosition(t,i,!1,_,m,E),b[v++]=E.x,b[v++]=E.y,b[v++]=E.z;for(m=0,_=r-2;_>0;_--)d.RectangleGeometryLibrary.computePosition(t,i,!1,_,m,E),b[v++]=E.x,b[v++]=E.y,b[v++]=E.z;for(var A=b.length/3*2,w=u.IndexDatatype.createTypedArray(b.length/3,A),G=0,R=0;R<b.length/3-1;R++)w[G++]=R,w[G++]=R+1;w[G++]=b.length/3-1,w[G++]=0;var P=new o.Geometry({attributes:new l.GeometryAttributes,primitiveType:o.PrimitiveType.LINES});return P.attributes.position=new o.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:b}),P.indices=w,P}function v(i){var r=(i=e.defaultValue(i,e.defaultValue.EMPTY_OBJECT)).rectangle,o=e.defaultValue(i.granularity,a.CesiumMath.RADIANS_PER_DEGREE),l=e.defaultValue(i.ellipsoid,t.Ellipsoid.WGS84),u=e.defaultValue(i.rotation,0);if(!e.defined(r))throw new n.DeveloperError("rectangle is required.");if(t.Rectangle.validate(r),r.north<r.south)throw new n.DeveloperError("options.rectangle.north must be greater than options.rectangle.south");var s=e.defaultValue(i.height,0),d=e.defaultValue(i.extrudedHeight,s);this._rectangle=t.Rectangle.clone(r),this._granularity=o,this._ellipsoid=l,this._surfaceHeight=Math.max(s,d),this._rotation=u,this._extrudedHeight=Math.min(s,d),this._offsetAttribute=i.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}v.packedLength=t.Rectangle.packedLength+t.Ellipsoid.packedLength+5,v.pack=function(i,r,a){if(!e.defined(i))throw new n.DeveloperError("value is required");if(!e.defined(r))throw new n.DeveloperError("array is required");return a=e.defaultValue(a,0),t.Rectangle.pack(i._rectangle,r,a),a+=t.Rectangle.packedLength,t.Ellipsoid.pack(i._ellipsoid,r,a),a+=t.Ellipsoid.packedLength,r[a++]=i._granularity,r[a++]=i._surfaceHeight,r[a++]=i._rotation,r[a++]=i._extrudedHeight,r[a]=e.defaultValue(i._offsetAttribute,-1),r};var _=new t.Rectangle,E=t.Ellipsoid.clone(t.Ellipsoid.UNIT_SPHERE),A={rectangle:_,ellipsoid:E,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};v.unpack=function(i,r,a){if(!e.defined(i))throw new n.DeveloperError("array is required");r=e.defaultValue(r,0);var o=t.Rectangle.unpack(i,r,_);r+=t.Rectangle.packedLength;var l=t.Ellipsoid.unpack(i,r,E);r+=t.Ellipsoid.packedLength;var u=i[r++],s=i[r++],d=i[r++],c=i[r++],p=i[r];return e.defined(a)?(a._rectangle=t.Rectangle.clone(o,a._rectangle),a._ellipsoid=t.Ellipsoid.clone(l,a._ellipsoid),a._surfaceHeight=s,a._rotation=d,a._extrudedHeight=c,a._offsetAttribute=-1===p?void 0:p,a):(A.granularity=u,A.height=s,A.rotation=d,A.extrudedHeight=c,A.offsetAttribute=-1===p?void 0:p,new v(A))};var w=new t.Cartographic;return v.createGeometry=function(t){var n,l,c=t._rectangle,p=t._ellipsoid,f=d.RectangleGeometryLibrary.computeOptions(c,t._granularity,t._rotation,0,m,w);if(!a.CesiumMath.equalsEpsilon(c.north,c.south,a.CesiumMath.EPSILON10)&&!a.CesiumMath.equalsEpsilon(c.east,c.west,a.CesiumMath.EPSILON10)){var y,v=t._surfaceHeight,_=t._extrudedHeight;if(a.CesiumMath.equalsEpsilon(v,_,0,a.CesiumMath.EPSILON2)){if((n=b(t,f)).attributes.position.values=s.PolygonPipeline.scaleToGeodeticHeight(n.attributes.position.values,v,p,!1),e.defined(t._offsetAttribute)){var E=n.attributes.position.values.length,A=new Uint8Array(E/3);y=t._offsetAttribute===i.GeometryOffsetAttribute.NONE?0:1,i.arrayFill(A,y),n.attributes.applyOffset=new o.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})}l=r.BoundingSphere.fromRectangle3D(c,p,v)}else{if(n=function(e,t){var i=e._surfaceHeight,r=e._extrudedHeight,a=e._ellipsoid,n=r,o=i,l=b(e,t),d=t.height,c=t.width,p=s.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,a,!1),f=p.length,g=new Float64Array(2*f);g.set(p);var h=s.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,a);g.set(h,f),l.attributes.position.values=g;var y=t.northCap,m=t.southCap,v=4;y&&(v-=1),m&&(v-=1);var _=2*(g.length/3+v),E=u.IndexDatatype.createTypedArray(g.length/3,_);f=g.length/6;for(var A,w=0,G=0;G<f-1;G++)E[w++]=G,E[w++]=G+1,E[w++]=G+f,E[w++]=G+f+1;if(E[w++]=f-1,E[w++]=0,E[w++]=f+f-1,E[w++]=f,E[w++]=0,E[w++]=f,y)A=d-1;else{var R=c-1;E[w++]=R,E[w++]=R+f,A=c+d-2}if(E[w++]=A,E[w++]=A+f,!m){var P=c+A-1;E[w++]=P,E[w]=P+f}return l.indices=E,l}(t,f),e.defined(t._offsetAttribute)){var G=n.attributes.position.values.length/3,R=new Uint8Array(G);t._offsetAttribute===i.GeometryOffsetAttribute.TOP?R=i.arrayFill(R,1,0,G/2):(y=t._offsetAttribute===i.GeometryOffsetAttribute.NONE?0:1,R=i.arrayFill(R,y)),n.attributes.applyOffset=new o.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:R})}var P=r.BoundingSphere.fromRectangle3D(c,p,v,h),D=r.BoundingSphere.fromRectangle3D(c,p,_,g);l=r.BoundingSphere.union(P,D)}return new o.Geometry({attributes:n.attributes,indices:n.indices,primitiveType:o.PrimitiveType.LINES,boundingSphere:l,offsetAttribute:t._offsetAttribute})}},function(i,r){return e.defined(r)&&(i=v.unpack(i,r)),i._ellipsoid=t.Ellipsoid.clone(i._ellipsoid),i._rectangle=t.Rectangle.clone(i._rectangle),v.createGeometry(i)}}));